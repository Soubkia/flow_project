# Potential Flow Around Obstacles
```
Adil Soubki (as5233)
Lyuchen Zhou (lz2511)
```

---

## Problem Statement

Consider the following 2D steady-state potential flow problems of a fluid flowing around a circular and rounded obstacles, between two parallel plates. Ideal (potential) flow assumption asserts that the flow is irrotational, inviscid and incompressible. The approaching velocity of thefluid is given as $u = 1\frac{m}{s}$ and $𝐿 = 5 m$.

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pfig1.png)

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pfig2.png)

Conservation of mass for an ideal flow in the control volume is given by the following Eq.

$$\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = 0 \text{ in the domain } \Omega$$
Where $u$ and $v$ are the components of the velocity vector in the $x$ and $y$ directions, respectively. For potential flow applications it is therefore convenient to define a velocity potential function, $\phi$, such that:$$u = \frac{\partial \phi}{\partial x} \text{ and } v = \frac{\partial \phi}{\partial y}$$Hence, the conservation of mass can be re-written in terms of the following Laplacian.

$$ \nabla^2 \phi = 0 \text{ in the domain } \Omega $$
And the boundary conditions are given in terms of the velocity potential $\phi$.

$$ \frac{\partial \phi}{\partial n} = -1 \text{ on AB (incoming velocity condition)} $$
$$ \frac{\partial \phi}{\partial n} = +1 \text{ on DC (outgoing velocity condition)} $$
$$ \frac{\partial \phi}{\partial n} = 0 \text{ on BC and AD (no slip condition)} $$
$$ \frac{\partial \phi}{\partial n} = 0 \text{ on the obstacle boundary (no slip condition)} $$
$$ \phi = 0 \text{ at the point C} $$

## Assignment

Modify the heat conduction MATLAB code, posted on the coursework website, to analyze the problem using 3-node linear triangular elements. The analysis should include two meshes for each problem. One coarse mesh with number of elements less than a 1000 elements and one fine mesh greater than 1000 elements. Use ABAQUS to generate a meshes for the problem and extract the required element and nodal information to build the mesh (the *.inp file generated by ABAQUS in your working directory).

---

## Question 1

>  (10%) Theoretical (physics) Background: e.g. problem description, fluid flow equations and derivation of potential flow, velocity potential and stream functions, definition of ideal fluid, etc.

As discussed in the problem statement, our solution will assume steady, ideal flow. This means we will make three assumptions.

1. $\mu = 0$, where $\mu$ is viscosity (Inviscid)
2. $\nabla \times V = 0$, where $V$ is velocity (Irrotational)
3. $\rho = const$, where $\rho$ is density (Incompressible)

From these assumptions we can derive some additional relations.

### Stream Function

If we expand our irrotational flow assumption from (2) we get

$$\nabla \times V = 0$$
$$ u_x + v_y = 0 $$

This is the same as the conservation of mass equation given in the problem description! Now, we define the differential of a function $\Psi$.

$$ d\psi = udx - vdy $$

The resulting function is called the *stream function* and has some notable properties.

* Constant along flow lines.
* Incompressibility is the integrability condition
* $\psi_x = u$
* $\psi_y = -v$
* The irrotationality condition implies that \psi satisfies the Laplace equation

### Velocity Potential

The harmonic function, $\phi$, which is conjugate to $\psi$ is called the velocity potential. This implies that the flux of the velocity potential (also known as the velocity) is inverted. We will use this in our code.

$$ \frac{\partial\phi}{\partial x} = -u $$
$$ \frac{\partial\phi}{\partial y} = -v $$

From our assumptions, the laplace equation holds as was mentioned in the problem statement.

$$ \nabla^2 \phi = 0 \text{ in the domain } \Omega$$

## Question 2

> (10%) Numerical (FEM) Background: e.g. derivation of FEM weak forms, Galerkin's method, discretization by triangular elements, postprocessing, etc.

### Weak Form

Before we can modify the heat conduction code to solve this problem, we must formulate our strong form. Using the the Laplace's as our governing equation and applying the boundaries given in the problem statement we get.

$$ \nabla^2 \phi = 0 \text{ in the domain } \Omega$$
$$ \frac{\partial \phi}{\partial n} = -1 \text{ on AB (incoming velocity condition)} $$
$$ \frac{\partial \phi}{\partial n} = +1 \text{ on DC (outgoing velocity condition)} $$
$$ \frac{\partial \phi}{\partial n} = 0 \text{ on BC and AD (no slip condition)} $$
$$ \frac{\partial \phi}{\partial n} = 0 \text{ on the obstacle boundary (no slip condition)} $$
$$ \phi = 0 \text{ at the point C} $$

Observing that this strong form is similar to the one used in heat conduction problems, we modify the weak form from the text (eq. 6.31) for our purposes.

$$ \text {Find } \phi \in U \text{such that}\\
	\int_\Omega (\nabla w)^\textbf{T} \textbf{ D} \nabla \phi \ d \Omega  = 
   \int_{\Gamma_V} w\overline{\textbf{V}}d\Gamma +
   \int_\Omega ws\ d\Omega \ \ \ \ \ \ \forall w \in U_o$$

In our case this simplifies since we have no "sources" ($s$).

$$ \text {Find } \phi \in U \text{such that}\\
	\int_\Omega (\nabla w)^\textbf{T} \textbf{ D} \nabla \phi \ d \Omega  = 
   \int_{\Gamma_V} w\overline{\textbf{V}}d\Gamma \ \ \ \ \ \ \forall w \in U_o$$

Where $\textbf{D}$ is a matrix of our density $\rho$. Due to our incompressibility assumption this becomes constant.

$$
\textbf{D} = \rho
\begin{bmatrix}
1 & 0 \\
0 & 1 \\
\end{bmatrix}
$$

### Descritization

As stated in the problem statement, we will use linear triangular elements to descritize the problem and mesh the fluid.

The trial solution in each triangular element is approximated by a linear function at each node.

$$ \theta^e_1(x,y) = \alpha^e_0 + \alpha^e_1 x^e_1 + \alpha^e_2 y^e_1 $$
$$ \theta^e_2(x,y) = \alpha^e_0 + \alpha^e_1 x^e_2 + \alpha^e_2 y^e_2 $$
$$ \theta^e_3(x,y) = \alpha^e_0 + \alpha^e_1 x^e_3 + \alpha^e_2 y^e_3 $$

This can be written as

$$
\underbrace{
	\begin{bmatrix} 
		\theta^e_1 \\
		\theta^e_2 \\
		\theta^e_3
	\end{bmatrix}
}_{\textbf{d}^e} =
\underbrace{
	\begin{bmatrix}
		1 & x^e_1 & y^e_1 \\
		1 & x^e_2 & y^e_2 \\
		1 & x^e_3 & y^e_3
	\end{bmatrix}
}_{\textbf{M}^e} \ .
\underbrace{
	\begin{bmatrix}
		\alpha^e_0 \\
		\alpha^e_1 \\
		\alpha^e_2 \\
	\end{bmatrix}
}_{\alpha^e}
$$

After some rearrangement, it can be shown that

$$ 
\theta(x, y) = 
p(x,y)(\textbf{M}^e)^{-1}\textbf{d}^e = 
\textbf{N}^e(x,y)\textbf{d}^e
$$

Where $\textbf{N}$ are shape functions and $p = \begin{bmatrix} 1 & x & y \end{bmatrix}$. After evaluation we write an expression for $\textbf{N}^e$.

$$
\textbf{N}^e = 
\begin{bmatrix}
	\textbf{N}_1^e \\
	\textbf{N}_2^e \\
	\textbf{N}_3^e \\
\end{bmatrix} =
\frac{1}{2A^e}
\begin{bmatrix}
x_2^e y_3^e - x_3^e y_3^3 + (y_2^e - y_3^e)x + (x_3^e - x_2^e)y \\
x_3^e y_1^e - x_1^e y_3^3 + (y_3^e - y_1^e)x + (x_1^e - x_3^e)y \\
x_1^e y_2^e - x_2^e y_1^3 + (y_1^e - y_2^e)x + (x_2^e - x_1^e)y \\
\end{bmatrix}
$$

It follows that

$$
\textbf{B}^e = \nabla \textbf{N}^e = 
\frac{1}{2A^e}
\begin{bmatrix}
(y_2^e - y_3^e) & (y_3^e - y_1^e) & (y_1^e - y_2^e) \\
(x_3^e - x_2^e) & (x_1^e - x_3^e) & (x_2^e - x_1^e) \\
\end{bmatrix}
$$

If we employ Galerkin's approximations on our weak form we can rewrite our problem in terms of shape functions for triangular elements.

$$ \phi(x,y) \approx \phi^e(x, y) = \textbf{N}^e\textbf{d}^e \ \ \ \ (x, y) \in \Omega^e $$

Using this and skipping some math (see the textbook page 190) we find.

$$
\begin{align}
&\textbf{K}^e = \int_{\Omega^e} (\textbf{B}^e)^T \ \textbf{D}^e \ \textbf{B}^e d\Omega \\
&\textbf{f}^e_\Gamma = - \int_{\Gamma^e} (\textbf{N}^e)^{\text{T}}\overline{\textbf{V}}d\Gamma \\
\end{align}
$$

Putting it all together we find from our weak form.

$$ \textbf{K}^e \textbf{d}^e = \textbf{f}^e $$

## Question 3

> (5%) Plots of the four meshes and their boundary conditions.

### Circle

#### Coarse

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_coarse_mesh.tif)

#### Fine

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_fine_mesh.tif)

### Pill

#### Coarse

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_coarse_mesh.tif)

#### Fine

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_fine_mesh.tif)

## Question 4

> (10%) Color plots of the velocity potential $\phi$ profile in $\Omega$ (including a scale, i.e. a color bar) done only for the fine mesh. If a color printer is not available, B&W plots will also be accepted.

### Circle

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_potential.png)

### Pill

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_potential.png)

## Question 5

> (10%) Plot the velocity profile $u$ and $v$ (as an arrow plot) in the domain $\Omega$ as obtained from the finite element solution, only for the coarse mesh. Note: be sure to scale the arrows appropriately.

### Circle

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_coarse_u.tif)

### Pill

# **TODO**

## Question 6

> (10%) Verify your MATLAB plots (in 4 and 5) by comparing to ABAQUS results. Are you getting similar results? 

### Circle

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_abaqus_arrows.tif)
![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_fine_vp.tif)

### Pill

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_abaqus_arrows.tif)
![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_fine_vp.tif)

## Question 7

> (5%) Color plots of the pressure distribution profile in $\Omega$, only for the fine mesh. Hint: Use Bernoulli theorem to obtain the pressure and assume that the density of the fluid is $\rho = 1$.

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_pressure.png)
![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_pressure.png)

## Question 8

> (20%) Four separate figures of the velocity potential $\phi$ field along the lines with coarse and fine meshes drawn on the same figure:
>
> 1. FGH in Fig. (a) as function of the angle (from 0 to 180).> 2. EE', FF', GG' in Fig. (b).>> Make sure to use legends, labels, grids and titles in the graphs.

### FGH

#### Coarse

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_coarse_path.png)

#### Fine

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/circle_fine_path.png)

### EE', FF', GG'

#### Coarse

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_coarse_path.png)

#### Fine

![](/Users/adil/dev/ENMEE4332/flow_project/docs/assets/pill_fine_path.png)

## Question 9

> (5%) The code should also output the Average Half Band Width (AHBW) of the global stiffness matrix (for both meshes). Add it to your report. Is the mesh numbering ideal or can it be improved to get sparser matrices?

## Question 10

> (5%) A short discussion on physical and numerical implications and some concluding remarks and suggestions on improving the project.

## Question 11

> (5%) Appendix A: Brief description of the code structure, code flow and its subroutines. The code should be uploaded as a zipped file to coarseworks.

## Question 12

> (5%) Appendix B: a Hardcopy of your code, including many comments in the code itself. Don't include mesh connectivity and coordinates in the hardcopy, these should only be uploaded with your zip file.

## Bonus

> (10%) Implement an isoparametric triangular element and use gauss quadrature for triangles to analyze the problem. Show that the results you get are in good agreement (should be identical) with the exact integration triangle implemented in the project.